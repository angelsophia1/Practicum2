```{r}
library(RSQLite)
# Create an ephemeral in-memory RSQLite database
con <- dbConnect(RSQLite::SQLite(), ":memory:")
dbSendQuery(con, "CREATE TABLE type (
  name varchar(255),
  PRIMARY KEY (name)
)")
dbSendQuery(con, "CREATE TABLE type_title (
  name VARCHAR(255),
  tconst VARCHAR(255),
  PRIMARY KEY (name, tconst),
  FOREIGN KEY (name) REFERENCES type(name),
  FOREIGN KEY (tconst) REFERENCES title_akas(tconst)
)")

dbSendQuery(con, "CREATE TABLE title_akas(
  tconst VARCHAR(255),
  ordering INT,
  title VARCHAR(255),
  region VARCHAR(255),
  language VARCHAR(255),
  isOriginalTitle INT,
  PRIMARY KEY (tconst, ordering),
  FOREIGN KEY (tconst) REFERENCES title_basics(tconst)
)")
dbSendQuery(con, "CREATE TABLE attribute(
  name VARCHAR(255),
  PRIMARY KEY (name)
)")
dbSendQuery(con, "CREATE TABLE akas_attributes(
  tconst VARCHAR(255),
  name VARCHAR(255),
  PRIMARY KEY (tconst, name),
  FOREIGN KEY (tconst) REFERENCES title_akas(tconst),
  FOREIGN KEY (name) REFERENCES attribute(name)
)")
dbSendQuery(con, "CREATE TABLE title_ratings (
  tconst VARCHAR(255),
  averageRating INT,
  numVotes INT,
  PRIMARY KEY (tconst),
  FOREIGN KEY (tconst) REFERENCES title_basics(tconst)
)")
dbSendQuery(con, "CREATE TABLE title_basics (
  tconst VARCHAR(255),
  titleType VARCHAR(255),
  primaryTitle VARCHAR(255),
  originalTitle VARCHAR(255),
  isAdult INT,
  startYear VARCHAR(255),
  endYear VARCHAR(255),
  runtimeMinutes INT,
  PRIMARY KEY (tconst)
)")
dbSendQuery(con, "CREATE TABLE genre_title (
  name VARCHAR(255),
  tconst VARCHAR(255),
  PRIMARY KEY (name, tconst),
  FOREIGN KEY (name) REFERENCES genre(name),
  FOREIGN KEY (tconst) REFERENCES title_basics(tconst)
)")
dbSendQuery(con, "CREATE TABLE genre (
  name VARCHAR(255),
  PRIMARY KEY (name)
)")
dbSendQuery(con, "CREATE TABLE title_episode(
  tconst VARCHAR(255),
  parentTconst VARCHAR(255),
  seasonNumber INT,
  episodeNumber INT,
  PRIMARY KEY (tconst),
  FOREIGN KEY (tconst) REFERENCES title_basics(tconst),
  FOREIGN KEY (parentTconst) REFERENCES title_principals(tconst)
)")
dbSendQuery(con, "CREATE TABLE title_principals (
  tconst VARCHAR(255),
  ordering INT,
  category VARCHAR(255),
  job VARCHAR(255),
  characters VARCHAR(255),
  PRIMARY KEY (tconst, ordering),
  FOREIGN KEY (tconst) REFERENCES title_basics(tconst)
)")
dbSendQuery(con, "CREATE TABLE title_position(
  tconst VARCHAR(255),
  nconst VARCHAR(255),
  isDirector INT,
  isWriter INT,
  PRIMARY KEY (tconst, nconst),
  FOREIGN KEY (tconst) REFERENCES title_basics(tconst),
  FOREIGN KEY (nconst) REFERENCES name_basics(nconst)
)")
dbSendQuery(con, "CREATE TABLE name_basics(
  nconst VARCHAR(255),
  primaryName VARCHAR(255),
  birthYear VARCHAR(255),
  deathYear VARCHAR(255),
  age INT,
  numberOfMovies INT,
  primary KEY (nconst)
)")
dbSendQuery(con, "CREATE TABLE principal_name(
  nconst VARCHAR(255),
  tconst VARCHAR(255),
  PRIMARY KEY (nconst, tconst),
  FOREIGN KEY (nconst) REFERENCES name_basics(nconst),
  FOREIGN KEY (tconst) REFERENCES title_principals(tconst)
)")
dbSendQuery(con, "CREATE TABLE profession (
  name VARCHAR(255),
  PRIMARY KEY (name)
)")
dbSendQuery(con, "CREATE TABLE name_profession(
  nconst VARCHAR(255),
  name VARCHAR(255),
  PRIMARY KEY (nconst, name),
  FOREIGN KEY (nconst) REFERENCES name_basics(nconst),
  FOREIGN KEY (name) REFERENCES profession(name)
)")
title_basics <- read.table(file="title_basics.tsv", sep = '\t', fill = TRUE, header = TRUE)
name_basics <- read.table(file="name_basics.tsv", sep = '\t', fill = TRUE, header = TRUE)
title_akas <- read.table(file="title_akas.tsv", sep = '\t', fill = TRUE, header = TRUE)
title_crew <- read.table(file="title_crew.tsv", sep = '\t', fill = TRUE, header = TRUE)
title_episode <- read.table(file="title_episode.tsv", sep = '\t', fill = TRUE, header = TRUE)
title_principals <- read.table(file="title_principals.tsv", sep = '\t', fill = TRUE, header = TRUE)
title_ratings <- read.table(file="title_ratings.tsv", sep = '\t', fill = TRUE, header = TRUE)
dbWriteTable(con, "title_basics_original", title_basics)
res <- dbSendQuery(con, "SELECT * FROM title_basics_original")
dbFetch(res)
dbClearResult(res)
```
